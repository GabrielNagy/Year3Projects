{% extends "layout.html" %}
{% block content %}
<div class="container">
  <div class="panel panel-default">
    <div class="panel-heading">
      {% if session.logged_in %}
      <div class="panel-title pull-left">Please upload a file.</div>
      <div class="pull-right">logged in as <em>{{ session.username }}</em> <small><a href="{{ url_for('logout') }}">(logout)</a></small></div>
      {% else %}
      <div class="pull-right"><em>not logged in. please <a href="{{ url_for('login') }}">log in</a> or <a href="{{ url_for('register') }}">register</a></em></div>
      {% endif %}
      <div class="clearfix"></div>
    </div>
    <div class="panel-body">
      {% include "utils/flasher.html" %}
      {% if session.logged_in %}
      <form action="{{ url_for('add_entry') }}" method=post enctype=multipart/form-data class="form-horizontal">
        <div class="form-group">
          <label class="control-label col-sm-2" for="file-source">Upload source file:</label>
          <div class="col-sm-10">
            <label class="btn btn-default"><input type="file" name="file-source" hidden></label>
          </div>
        </div>
        <div class="form-group">
          <label class="control-label col-sm-2" for="file-header">Upload header file:</label>
          <div class="col-sm-10">
            <label class="btn btn-default"><input type="file" name="file-header" hidden></label>
          </div>
        </div>
        <div class="form-group">
          <div class="col-sm-offset-2 col-sm-10">
            <button type="submit" class="btn btn-default">Submit</button>
          </div>
        </div>
      </form>
    </div>
  </div>
  {% for file in files %}
  <hr />
  <div class="panel panel-primary">
    <div class="panel-heading clearfix">
      <h4 class="panel-title pull-left" style="padding-top: 7.5px;"><a href="{{ url_for('uploads', path=file.id, filename=file.value)}}">{{ file.value }}</a> <small>(id: {{ file.id }})</small></h4>
      <div class="pull-right">
        <button onclick="start_task('{{file.id}}');" class="btn btn-default">Begin test</button>
        <button onclick="location.href = '{{ url_for('delete_file', path=file.id) }}';" class="btn btn-danger">Delete item</button>
      </div>
    </div>
    <div class="panel-body">
    <div id="progress-{{file.id}}"></div>
    </div>
  </div>
  {% else %}
  <div class="panel panel-primary">
    <div class="panel-heading clearfix">
      <h4 class="panel-title pull-left">You haven't uploaded any files yet.</h4>
    </div>
  </div>
  {% endfor %}

  {% else %}
  Welcome to the application tester! In order to use it and upload files, you need to first register an account.
  {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script src="{{url_for('static', filename='scripts.js')}}"></script>
{% endblock %}
